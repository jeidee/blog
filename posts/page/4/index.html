<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="pinterest" content="nopin">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="generator" content="Hugo 0.31.1" />

<link rel="alternate" type="application/rss+xml" title="RSS" href="https://jeidee.github.io/posts/index.xml">

<link rel="canonical" href="https://jeidee.github.io/posts/">


    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/solarized_dark.min.css">
    <title>Posts - Erlang &amp; Go</title>
    
    <link href="https://jeidee.github.io/css/styles.css" rel="stylesheet">
    

  </head>

  <body>
    
    
    

    <header class="l-header">
      <nav class="navbar navbar-default">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://jeidee.github.io/">Erlang &amp; Go</a>
          </div>

          

        </div>
      </nav>
    </header>

    <main>
      <div class="container">
        
<div class="row">
  <div class="col-md-8">

    
    <header class="page-header">
      <h1>Posts</h1>
    </header>
    

    <ul class="p-articles">
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2016-02-03T00:00:00JST">Feb 3, 2016</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2016/02/03/ejabberdec9980-cowboy-ec97b0eb8f99/">ejabberd와 cowboy 연동</a></h2>
  </header>

  
  <div class="summary">ejabberd에 포함된 관리자용 웹사이트는 인터페이스가 썩 편하지 않다. 더군다나 admin 모듈(ejabberd_web_admin.erl)을 살펴보면 erlang 코드에서 직접 html을 생성하도록 코드가 작성되어 있어 수정하기가 여간 불편한게 아니다.
이러한 이유로 erlang web framework인 cowboy를 연동하기로 했다.
cowboy는 현재 erlang/otp 18에서 컴파일 가능하기 때문에 다음과 같이 준비가 되어 있어야 한다.
준비  erlang/otp 18 ejabberd 15.04  ejabberd의 최신 버전의 경우 erlang/otp 18을 정상 지원하지만, 현재 사용하고 있는 15.04의 경우 일부 모듈(특히 ejabberd_riak관련 의존성 모듈들)은 erlang/otp 18에서 컴파일 되지 않는 문제가 있다.</div>

  <footer>
    <a href="https://jeidee.github.io/2016/02/03/ejabberdec9980-cowboy-ec97b0eb8f99/" title="ejabberd와 cowboy 연동">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2016-01-15T00:00:00JST">Jan 15, 2016</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2016/01/15/couchbase-cberl-ec82acec9aa9ed95b4ec849c-view-eca1b0ed9a8cec8b9c-eca3bcec9d98ec82aced95ad/">couchbase cberl 사용해서 view 조회시 주의사항</a></h2>
  </header>

  
  <div class="summary">couchbase의 view 조회시 데이터의 최신 본을 얻지 못할 수도 있다.
이러한 이유는 속도의 향상을 위해 stale옵션의 기본값이 true로 설정되어 있어서 그런데, 명시적으로 stale옵션을 false로 지정해야 최신 데이터가 적용된 view를 구할 수 있다.
cberl:view()함수를 사용할 때, stale옵션을 false로 지정하는 방법은 다음과 같다.
https://gist.github.com/jeidee/79e08693d3c6be338e31
Args에 {stale, false}를 추가하면 된다.</div>

  <footer>
    <a href="https://jeidee.github.io/2016/01/15/couchbase-cberl-ec82acec9aa9ed95b4ec849c-view-eca1b0ed9a8cec8b9c-eca3bcec9d98ec82aced95ad/" title="couchbase cberl 사용해서 view 조회시 주의사항">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2016-01-06T00:00:00JST">Jan 6, 2016</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2016/01/06/couchbase-eb8f84ed8190eba8bced8ab8-ebb0b1ec9785/">couchbase 도큐먼트 백업</a></h2>
  </header>

  
  <div class="summary"> cbbackup http://[host]:8091 [backup-location] -x design\_doc\_only=1 -b [bucket-name]   출처  </div>

  <footer>
    <a href="https://jeidee.github.io/2016/01/06/couchbase-eb8f84ed8190eba8bced8ab8-ebb0b1ec9785/" title="couchbase 도큐먼트 백업">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-12-30T00:00:00JST">Dec 30, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/12/30/ejabberd-couchbase-ec82acec9aa9ed9598eab8b0/">ejabberd couchbase 사용하기</a></h2>
  </header>

  
  <div class="summary">mongodb와 마찬가지로 couchbase역시 ejabberd에서 공식 지원하지 않는다. erlang driver도 커뮤니티에서 만든 driver만 제공하므로 사용상 주의할 필요가 있다.
couchbase의 erlang driver인 cberl을 사용해서 ejabberd용 couchbase 모듈을 만들어보자.
준비  erlang/otp 17(or 17.5) ejabberd 15.04 couchbase server 4.x  cberl의 경우 빌드서버에는 libcouchbase2와 libcouchbase-dev가 설치되어 있어야 하며, 운영서버에는 libcouchbase2가 설치되어 있어야 한다.
 sudo wget -O/etc/yum.repos.d/couchbase.repo http://packages.couchbase.com/rpm/couchbase-centos62-x86_64.repo sudo yum check-update sudo yum install &amp;#8211;enablerepo=epel libcouchbase2 libcouchbase-devel  cberl의 경우 ejabberd에 연동시 cberl_drv.</div>

  <footer>
    <a href="https://jeidee.github.io/2015/12/30/ejabberd-couchbase-ec82acec9aa9ed9598eab8b0/" title="ejabberd couchbase 사용하기">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-12-08T00:00:00JST">Dec 8, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/12/08/mongo-sharded-cluster/">mongo sharded cluster</a></h2>
  </header>

  
  <div class="summary">mongodb의 샤드 클러스터를 구성하는 방법은 다음과 같다.
준비 mongod가 설치된 서버가 다음과 같이 3대 준비되어 있다고 가정한다.
#1 : 192.168.56.101
#1 : 192.168.56.102
#1 : 192.168.56.103
shard 서버 구동 @192.168.56.101/102/103 공통
 nohup mongod &amp;#8211;shardsvr &amp;#8211;dbpath /var/lib/mongo/ &gt; /var/log/mongod.log &amp;  config 서버 구동 @192.168.56.101
 mkdir /var/lib/mongo/configdb nohup mongod &amp;#8211;configsvr &amp;#8211;dbpath /var/lib/mongo/configdb &gt; /var/log/mongod_config.log &amp;  mongos 구동 @192.168.56.101
 nohup mongos &amp;#8211;configdb 192.168.56.101:27019 &amp;#8211;chunkSize 1 &gt; /var/log/mongos.log &amp;  클러스터 설정 @192.</div>

  <footer>
    <a href="https://jeidee.github.io/2015/12/08/mongo-sharded-cluster/" title="mongo sharded cluster">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-12-08T00:00:00JST">Dec 8, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/12/08/riak-ed81b4eb9facec8aa4ed84b0-eab5acec84b1/">riak 클러스터 구성</a></h2>
  </header>

  
  <div class="summary">riak 설치 환경은 centos-6.7, riak 2.1.2를 기준으로 한다.
riak 설정 riak.conf만 수정해도 된다. (단, 방화벽 설정을 하려면 app.config를 수정해야 한다.)
클러스터로 구성할 2개의 riak 노드가 다음과 같이 준비되어 있다.
 riak@192.168.56.101 riak@192.168.56.102  두 riak 노드간 tcp/udp의 방화벽을 해제하거나 다음 문서를 참고해서 특정 포트를 열어 놓아야 한다.
 Riak network security and firewall configurations  riak.conf 수정 ** riak@192.168.56.101 **
 listener.protobuf.internal = 0.0.0.0:8087 nodename = riak@192.168.56.101 distributed_cookie = riak storage_backend = leveldb   listener.</div>

  <footer>
    <a href="https://jeidee.github.io/2015/12/08/riak-ed81b4eb9facec8aa4ed84b0-eab5acec84b1/" title="riak 클러스터 구성">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-12-08T00:00:00JST">Dec 8, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/12/08/ec85b0ec9db5ec8aa4ed94bcec96b4eab080-eca491eb8584ec9790eab28c-eca3bceb8a94-9eab080eca780-eab590ed9b88/">셰익스피어가 중년에게 주는 9가지 교훈</a></h2>
  </header>

  
  <div class="summary">첫째. 학생으로 계속 남아 있어라.
배움을 포기하는 순간 우리는 폭삭 늙기 시작한다.
둘째. 과거를 자랑하지 마라.
옛날 이야기밖에 가진 것이 없을 때 당신은 처량해진다.
삶을 사는 지혜는 지금 가지고 있는 것을 즐기는 것이다,
셋째. 젊은 사람과 경쟁하지 마라.
대신 그들의 성장을 인정하고 그들에게 용기를 주고
그들과 함께 즐겨라,
넷째. 부탁 받지 않은 충고는 굳이 하려고 마라.
늙은이의 기우와 잔소리로 오해 받는다.
다섯째. 삶을 철학으로 대체하지 마라.
로미오가 한 말을 기억하라</div>

  <footer>
    <a href="https://jeidee.github.io/2015/12/08/ec85b0ec9db5ec8aa4ed94bcec96b4eab080-eca491eb8584ec9790eab28c-eca3bceb8a94-9eab080eca780-eab590ed9b88/" title="셰익스피어가 중년에게 주는 9가지 교훈">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-11-27T00:00:00JST">Nov 27, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/11/27/ejabberd-mongo-db-ec82acec9aa9ed9598eab8b0/">ejabberd mongo-db 사용하기</a></h2>
  </header>

  
  <div class="summary">ejabberd에는 mongodb를 사용할 수 있는 모듈이 없다.
mongodb에서도 erlang driver를 공식적으로 지원하지 않으며, community driver(일반 개발자가 만들어 공개한)만 사용할 수 있다.
community erlang driver중에서 mongodb-erlang을 사용해 ejabberd용 mongodb 모듈을 만들어 보자.
준비  erlang/otp 17(or 17.5) ejabberd 15.04 mongodb 3.0.7  mongodb-erlang의 경우 의존하고 있는 라이브러리 중에서 pbkdf2가 최신 버전의 erlang(17~)에서 컴파일이 안되는 문제(rebar.config에 명시된 {require_min_otp_vsn, &#8220;R14B03&#8221;}. 때문)가 있고, bson-erlang 역시 동일한 문제가 있어, 이를 수정해서 다음과 같이 fork를 생성했다.</div>

  <footer>
    <a href="https://jeidee.github.io/2015/11/27/ejabberd-mongo-db-ec82acec9aa9ed9598eab8b0/" title="ejabberd mongo-db 사용하기">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-11-13T00:00:00JST">Nov 13, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/11/13/erlang-applicationec9790ec849c-protocol-buffer-ec82acec9aa9ed9598eab8b0/">erlang application에서 protocol buffer 사용하기</a></h2>
  </header>

  
  <div class="summary">이번 역시, rebar를 사용해 프로젝트를 생성했다고 가정한다.
basho의 protobuffs 라이브러리를 추가해 보도록 하자.
rebar.config 수정 이전 포스트를 참고해서 기본 작업(sub_dirs 추가 등)은 완료했다고 가정한다.
 {deps, [ {'lager', &quot;.*&quot;, {git, &quot;https://github.com/basho/lager&quot;, &quot;&quot;}}, {protobuffs, &quot;.*&quot;, {git, &quot;git://github.com/basho/erlang_protobuffs.git&quot;, {branch, &quot;master&quot;}}} ]}.   deps에 protobuffs, &#8230; 행을 복사해 넣는다.  xxx.proto 파일 생성 프로토콜을 정의한 *.proto파일을 생성한다.
예를 들면 다음과 같은 simple.proto파일을 src 디렉토리 밑에 추가한다.
 package simple; message Person { required string name = 1; required string address = 2; required string phone_number = 3; required int32 age = 4; optional Location location = 5; } message Location { required string region = 1; required string country = 2; }  make로 컴파일하고 나면 rebar가 .</div>

  <footer>
    <a href="https://jeidee.github.io/2015/11/13/erlang-applicationec9790ec849c-protocol-buffer-ec82acec9aa9ed9598eab8b0/" title="erlang application에서 protocol buffer 사용하기">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-11-11T00:00:00JST">Nov 11, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/11/11/erlang-applicationec9790-lagereba19ceab1b0-ecb694eab080ed9598eab8b0/">erlang application에 lager(로거)  추가하기</a></h2>
  </header>

  
  <div class="summary">rebar를 사용해 프로젝트를 생성했다고 가정한다.
erlang의 로거 라이브러리 중에서 많이 사용되는 basho/lager를 추가해 보도록 하자.
rebar.config 수정  %% -\*- erlang -\*- {sub_dirs, [ &quot;apps/chat&quot;, &quot;deps&quot;, &quot;rel&quot; ]}. {erl_opts, [ {parse\_transform, lager\_transform}, %% for lager debug_info, fail\_on\_warning ]}. %% {require\_otp\_vsn, &quot;R14&quot;}. %% Example, uncomment to retrieve cowboy as a dep. {deps, [ {'lager', &quot;.*&quot;, {git, &quot;https://github.com/basho/lager&quot;, &quot;&quot;}} ]}.   sub_dirs에 deps 디렉토리를 추가하고, erl_opts(erlang 컴파일러 옵션)에 {parse_transform, lager_transform}을 추가한다.</div>

  <footer>
    <a href="https://jeidee.github.io/2015/11/11/erlang-applicationec9790-lagereba19ceab1b0-ecb694eab080ed9598eab8b0/" title="erlang application에 lager(로거)  추가하기">Read More…</a>
  </footer>
</article>
</li>
      
    </ul>

    
<nav>
  <ul class="pager">

    
    <li><a href="/posts/page/3/">Previous</a></li>
    

    
    <li><a href="/posts/page/5/">Next</a></li>
    

  </ul>
</nav>



  </div>
  <div class="col-md-4">
    
<aside class="l-sidebar">

  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">LATESTS</div>
    </div>
    <div class="list-group">
      
      <a href="https://jeidee.github.io/2017/08/31/upstart-ec84a4eca095/" class="list-group-item">upstart 설정</a>
      
      <a href="https://jeidee.github.io/2017/06/08/centosec9790ec849c-mongodb-ec84a4ecb998ec9980-service-eb93b1eba19d/" class="list-group-item">CentOS에서 MongoDB 설치와 Service 등록</a>
      
      <a href="https://jeidee.github.io/2017/01/25/couchbase-cberlec9790-lcb_cntl-ed95a8ec8898-ecb694eab080/" class="list-group-item">couchbase cberl에 lcb_cntl 함수 추가</a>
      
      <a href="https://jeidee.github.io/2017/01/25/couchbase-cberlec9d98io-pluginec9d84-libeventeba19c-ebb380eab2bd/" class="list-group-item">couchbase cberl의IO Plugin을 libevent로 변경</a>
      
      <a href="https://jeidee.github.io/2017/01/25/ejabberdec9d98-deps-eb9dbcec9db4ebb88ceb9faceba6ac-ec8898eca095-ed9b84-ecbbb4ed8c8cec9dbcec9790ec849c-eb8884eb9dbdeb90a0-eb958c/" class="list-group-item">ejabberd의 deps 라이브러리 수정 후 컴파일에서 누락될 때</a>
      
      <a href="https://jeidee.github.io/2017/01/03/aws-dynamodb-for-go/" class="list-group-item">AWS DynamoDB for Go</a>
      
      <a href="https://jeidee.github.io/2016/12/21/aws-credentialseab080-upstart-eb93b1ec9790ec849c-eca09ceb8c80eba19c-eb8f99ec9e91ed9598eca780-ec958aec9d84-eab2bdec9ab0/" class="list-group-item">AWS Credentials가 upstart 등에서 제대로 동작하지 않을 경우</a>
      
      <a href="https://jeidee.github.io/2016/09/02/c-rest-sdk/" class="list-group-item">c&#43;&#43; REST SDK</a>
      
      <a href="https://jeidee.github.io/2016/09/01/c-openssl-aes-ecb/" class="list-group-item">c&#43;&#43; openssl AES ECB</a>
      
      <a href="https://jeidee.github.io/2016/09/01/cc-hex-string-to-byte-array/" class="list-group-item">c/c&#43;&#43; hex string to byte array</a>
      
    </div>
  </section>

  
  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">CATEGORY</div>
    </div>
    <div class="list-group">
      
      <a href="https://jeidee.github.io/categories/erlang" class="list-group-item">erlang</a>
      
      <a href="https://jeidee.github.io/categories/ejabberd" class="list-group-item">ejabberd</a>
      
      <a href="https://jeidee.github.io/categories/elixir" class="list-group-item">elixir</a>
      
      <a href="https://jeidee.github.io/categories/ios" class="list-group-item">ios</a>
      
      <a href="https://jeidee.github.io/categories/c&#43;&#43;" class="list-group-item">c&#43;&#43;</a>
      
      <a href="https://jeidee.github.io/categories/node.js" class="list-group-item">node.js</a>
      
      <a href="https://jeidee.github.io/categories/utility" class="list-group-item">utility</a>
      
      <a href="https://jeidee.github.io/categories/android" class="list-group-item">android</a>
      
      <a href="https://jeidee.github.io/categories/go" class="list-group-item">go</a>
      
      <a href="https://jeidee.github.io/categories/couchbase" class="list-group-item">couchbase</a>
      
    </div>
  </section>
  
  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">TAG</div>
    </div>
    <div class="list-group">
      
      <a href="https://jeidee.github.io/tags/tutorial" class="list-group-item">tutorial</a>
      
      <a href="https://jeidee.github.io/tags/ndk" class="list-group-item">ndk</a>
      
      <a href="https://jeidee.github.io/tags/express" class="list-group-item">express</a>
      
      <a href="https://jeidee.github.io/tags/mnesia" class="list-group-item">mnesia</a>
      
      <a href="https://jeidee.github.io/tags/mysql" class="list-group-item">mysql</a>
      
      <a href="https://jeidee.github.io/tags/cberl" class="list-group-item">cberl</a>
      
      <a href="https://jeidee.github.io/tags/clustering" class="list-group-item">clustering</a>
      
      <a href="https://jeidee.github.io/tags/custom-module" class="list-group-item">custom-module</a>
      
      <a href="https://jeidee.github.io/tags/debug" class="list-group-item">debug</a>
      
      <a href="https://jeidee.github.io/tags/http" class="list-group-item">http</a>
      
    </div>
  </section>
  

</aside>


  </div>
</div>

      </div>
    </main>

    <footer class="l-footer">
      <div class="container">
        <p><span class="h-logo">&copy; Erlang &amp; Go</span></p>
        <aside>
          <p>Powered by <a href="https://gohugo.io/">Hugo</a>.</p>
          <p><a href="https://github.com/dim0627/hugo_theme_beg">Beg</a> designed by <a href="http://yet.unresolved.xyz/">Daisuke Tsuji</a>.</p>
        </aside>
      </div>
    </footer>

    <script src="//code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

