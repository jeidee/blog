<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="pinterest" content="nopin">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="generator" content="Hugo 0.31.1" />

<link rel="alternate" type="application/rss+xml" title="RSS" href="https://jeidee.github.io/categories/ejabberd/index.xml">

<link rel="canonical" href="https://jeidee.github.io/categories/ejabberd/">


    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/solarized_dark.min.css">
    <title>Ejabberd - Erlang &amp; Go</title>
    
    <link href="https://jeidee.github.io/css/styles.css" rel="stylesheet">
    

  </head>

  <body>
    
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-110408557-1', 'auto');
ga('send', 'pageview');
</script>

    

    <header class="l-header">
      <nav class="navbar navbar-default">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://jeidee.github.io/">Erlang &amp; Go</a>
          </div>

          

        </div>
      </nav>
    </header>

    <main>
      <div class="container">
        
<div class="row">
  <div class="col-md-8">

    
    <header class="page-header">
      <h1>Ejabberd</h1>
    </header>
    

    <ul class="p-articles">
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-06-03T00:00:00JST">Jun 3, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/06/03/ejabberdec9790-redis-eb9dbcec9db4ebb88ceb9faceba6aceredis-ecb694eab080/">ejabberd에 redis 라이브러리(eredis) 추가</a></h2>
  </header>

  
  <div class="summary">ejabberd가 15.03버전이 릴리즈되면서 redis 지원이 추가되었다.
클라이언트 세션 관리를 redis로 할 수 있는데 직접 연관된 모듈은 ejabberd_sm 모듈이다.
redis를 사용하려면 다음과 같이 configure에서 &#8211;enable-redis 옵션을 추가해 주면 된다.
 ./configure &amp;#8230; &amp;#8211;enable-redis  위와 같이 해 준후에 rebar를 사용해 의존 라이브러리를 다운로드 받아 컴파일해야 한다.
 rebar get-deps rebar compile  그런 후 make &amp;&amp; make install을 수행하면 된다.
ejabberd.yml에서 sm_db_type을 redis로 설정하기 위해서는 다음 라인을 추가해 주면 된다.</div>

  <footer>
    <a href="https://jeidee.github.io/2015/06/03/ejabberdec9790-redis-eb9dbcec9db4ebb88ceb9faceba6aceredis-ecb694eab080/" title="ejabberd에 redis 라이브러리(eredis) 추가">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-06-02T00:00:00JST">Jun 2, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/06/02/gloox-xmppping/">gloox xmppPing</a></h2>
  </header>

  
  <div class="summary">gloox의 경우 tcp 연결이 비정상적으로 종료되었을 때 disconnect를 감지할 수 없는 경우가 있다.
이럴 경우를 대비해 xmpp 서버에 주기적으로 ping을 보내고 pong을 수신해서 연결 상태를 관리하는 것이 좋다.
class MsgClient : public MessageSessionHandler , &amp;#8230; , EventHandler { private: int m_heartBeat; }; void MsgClient::heartBeat() { m\_client-&gt;xmppPing(m\_client-&gt;jid(), this); if (++m_heartBeat &gt; 3) { LOGD(&quot;허트비트 무응답 초과로 연결 종료!&quot;); m_client-&gt;disconnect(); } } void MsgClient::handleEvent(const Event&amp; event) { switch (event.eventType()) { case Event::PingPing: LOGD(&quot;PingPing&quot;); break; case Event::PingPong: LOGD(&quot;PingPong&quot;); &amp;#8211;m_heartBeat; break; case Event::PingError: LOGE(&quot;PingError&quot;); break; default: break; } return; } // ConnectionListener void MsgClient::onConnect() { LOGD(&quot;connected!</div>

  <footer>
    <a href="https://jeidee.github.io/2015/06/02/gloox-xmppping/" title="gloox xmppPing">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-04-21T00:00:00JST">Apr 21, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/04/21/gloox-for-android/">gloox for android</a></h2>
  </header>

  
  <div class="summary">gloox를 android에서 사용하기 위한 과정을 살펴보자.
사전 준비 작업 다음과 같은 환경이 구축되어 있다고 가정한다.
 개발 환경 : Mac OS X Yosemite 10.10.3 Android Studio : 1.1.0  Android SDK 경로는 ~/Android/sdk로 변경  NDK  ~/Android/ndk에 복사하고 path 지정   Android Studio에 ndk 설정 Preference &gt; External Tools에서 + 버튼을 클릭해 javah, ndk-build, ndk-build clean 도구를 추가한다.
1) javah
2) ndk-build
3) ndk-build clean
Android Project 생성후 NDK 테스트 1) GlooxForAndroid 이름을 갖는 Android Project를 생성한다.</div>

  <footer>
    <a href="https://jeidee.github.io/2015/04/21/gloox-for-android/" title="gloox for android">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-03-30T00:00:00JST">Mar 30, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/03/30/ngrinderec9980-smack-apieba5bc-ec82acec9aa9ed95b4-ejabberd-ed858cec8aa4ed8ab8ed9598eab8b0/">nGrinder와 smack api를 사용해 ejabberd 테스트하기</a></h2>
  </header>

  
  <div class="summary">테스트 환경 smack api는 3.2.2, nGrinder는 3.3 버전이다.
192.168.56.101서버에 ejabberd가 실행중이고, ngrinder-controller, -agent, -monitor가 실행중이라고 가정한다.
테스트 스크립트 작성 1) Script &gt; Create a script 버튼을 클릭해 다음과 같이 스크립트를 만들어 준다.
 Script Name : testXmpp
Type : Groovy
URL to be tested :
Create Lib and Resource folders : Check
 2) smack-3.2.2.jar 파일을 lib 폴더에 업로드한다.
3) 만들어진 스크립트를 다음과 같이 수정한다.
testXmpp.groovy
package org.ngrinder; import static net.</div>

  <footer>
    <a href="https://jeidee.github.io/2015/03/30/ngrinderec9980-smack-apieba5bc-ec82acec9aa9ed95b4-ejabberd-ed858cec8aa4ed8ab8ed9598eab8b0/" title="nGrinder와 smack api를 사용해 ejabberd 테스트하기">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-03-05T00:00:00JST">Mar 5, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/03/05/ejabberd-ed8ca8ed82b7-ed9b84ed82b9-ebb08f-ed9584ed84b0eba781/">ejabberd 패킷 후킹 및 필터링</a></h2>
  </header>

  
  <div class="summary">ejabberd에서 패킷을 후킹한 후 필터링하고 싶다면 다음과 같이 커스텀 모듈을 생성해 처리하면 된다.
다음 코드는 chat 메세지 패킷을 가로체 디버그 로그에 출력해 주는 소스이다.
-module(mod\_packet\_hook). -behaviour(gen_mod). -export([start/2, stop/1]). -export([on\_filter\_packet/1]). -include(&quot;ejabberd.hrl&quot;). -include(&quot;jlib.hrl&quot;). -include(&quot;logger.hrl&quot;). start(\_Host, \_Opts) -&gt; ejabberd\_hooks:add(filter\_packet, global, ?MODULE, on\_filter\_packet, 0), ok. stop(_Host) -&gt; ejabberd\_hooks:delete(filter\_packet, global, ?MODULE, on\_filter\_packet, 0), ok. on\_filter\_packet({From, To, XML} = Packet) -&gt; %% does something with a packet %% should return modified Packet or atom \`drop\` to drop the packet Type = proplists:get_value(&lt;&lt;&quot;type&quot;&gt;&gt;, XML#xmlel.</div>

  <footer>
    <a href="https://jeidee.github.io/2015/03/05/ejabberd-ed8ca8ed82b7-ed9b84ed82b9-ebb08f-ed9584ed84b0eba781/" title="ejabberd 패킷 후킹 및 필터링">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-03-04T00:00:00JST">Mar 4, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/03/04/ejabberd-external-component-ec97b0eb8f99/">ejabberd external component 연동</a></h2>
  </header>

  
  <div class="summary">xmpp component 개요 xmpp에는 external component 관련 공식 프로토콜인 Jabber Component Protocol이 있다.
Jabber Component Protocol은 외부 컴포넌트를 XMPP서버와 연동하기 위한 규약을 제안하는데 크게 accept와 connect에 대한 XML 스키마와 handshake flow를 명세하고 있다.
xmpp의 external component는 프로토콜만 준수한다면 어떤 언어를 사용해서도 구현할 수 있다. 3rd-party 컴포넌트를 ejabberd와 연동하는 방법은 Install Components and Transports to othe networks 문서를 참고하도록 한다.
echo-bot component 만들어서 연동해 보기 node-xmpp-component 모듈을 사용해서 간단한 에코봇을 컴포넌트로 만들어 ejabberd와 연동해 보도록 하자.</div>

  <footer>
    <a href="https://jeidee.github.io/2015/03/04/ejabberd-external-component-ec97b0eb8f99/" title="ejabberd external component 연동">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-01-31T00:00:00JST">Jan 31, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/01/31/ejabberd-riak-ed999cec84b1ed9994-ec84a4ecb998/">ejabberd riak 활성화 설치</a></h2>
  </header>

  
  <div class="summary">riak를 활성화하려면 다음과 같이 설치한다.
 $ ./configure &amp;#8211;enable-riak $ make &amp;&amp; make install  ejabberd 15.03 이후 릴리즈에서는 erlc 버전이 r17 이상 버전에서 정상 컴파일되는 것을 확인했다.
ejabberd 14.07 이전 릴리즈에서는 meck.erl 관련 compile에러가 날 경우 erlc 버전이 r16b3인지 확인해야 한다.
riak 모듈을 제외한 모든 플러그인 모듈을 설치하기 위해서는 다음과 같이 설치하면 된다.
 $ ./configure &amp;#8211;enable-all &amp;#8211;disable-riak  </div>

  <footer>
    <a href="https://jeidee.github.io/2015/01/31/ejabberd-riak-ed999cec84b1ed9994-ec84a4ecb998/" title="ejabberd riak 활성화 설치">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-01-31T00:00:00JST">Jan 31, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/01/31/ejabberd-ec84a4ecb998eca084-ed9584ec8898-eb9dbcec9db4ebb88ceb9faceba6ac/">ejabberd 설치전 필수 라이브러리</a></h2>
  </header>

  
  <div class="summary">PAM 라이브러리 설치
 $ sudo apt-get install libpam0g-dev  expat 라이브러리 설치
 $ sudo apt-get install libexpat1-dev  rebar 설치
 $ sudo apt-get install rebar  ssl 라이브러리 설치
 $ sudo apt-get install libssl-dev  yaml 라이브러리 설치
 $ sudo apt-get install libyaml-dev  </div>

  <footer>
    <a href="https://jeidee.github.io/2015/01/31/ejabberd-ec84a4ecb998eca084-ed9584ec8898-eb9dbcec9db4ebb88ceb9faceba6ac/" title="ejabberd 설치전 필수 라이브러리">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-01-22T00:00:00JST">Jan 22, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/01/22/ejabberd-bosheba5bc-httpseba19c-ec84a4eca095ed9598eab8b0/">ejabberd bosh를 https로 설정하기</a></h2>
  </header>

  
  <div class="summary">ejabberd에서 bosh를 설정하기 위해서는 다음과 같이 ejabberd.yml에서 ejabberd_http 모듈을 설정해야 한다.
 &amp;#8211; port: 5280 module: ejabberd_http request_handlers: &quot;/hello&quot;: mod\_http\_hello &quot;/api&quot;: mod\_http\_api web_admin: true http_poll: true http_bind: true \## register: true captcha: true  위와 같이 설정할 경우 admin, api, bosh가 모두 http://localhost:5280 하에서 동작하게 되는데 https로 설정하기 위해서는 다음과 같이 5223 tls 설정과 유사하게 설정하면 된다.
 &amp;#8211; port: 5281 module: ejabberd_http certfile: &quot;/path/to/server.pem&quot; tls: true http_bind: true  주의할 것은 tls 설정항목이 starttls가 아니라 tls라는 것이다.</div>

  <footer>
    <a href="https://jeidee.github.io/2015/01/22/ejabberd-bosheba5bc-httpseba19c-ec84a4eca095ed9598eab8b0/" title="ejabberd bosh를 https로 설정하기">Read More…</a>
  </footer>
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-01-21T00:00:00JST">Jan 21, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://jeidee.github.io/posts/">posts</a></li>
      
    </ul>
    <h2 class="title"><a href="https://jeidee.github.io/2015/01/21/ejabberd-clustering/">ejabberd clustering</a></h2>
  </header>

  
  <div class="summary">process-one 사이트에 명시된 p1-spec 문서는 찾을 수가 없었다.
대신 install guide에 포함된 clustering guide를 살펴보고 cluster-node를 구축하는 방법을 살펴보도록 한다.
cluster 구성을 위한 환경 다음과 같이 Virtualbox를 사용해 Windows 7 호스트에 ubuntu 14.10 게스트 OS를 설치해서 클러스터링을 구성한다.
 호스트 OS  Windows 7  게스트 OS #1  Ubuntu 14.10 desktop ip: 192.168.56.101 hostname: hello.world ejabberd 역할: slave node  게스트 OS #2  Ubuntu 14.10 desktop ip: 192.</div>

  <footer>
    <a href="https://jeidee.github.io/2015/01/21/ejabberd-clustering/" title="ejabberd clustering">Read More…</a>
  </footer>
</article>
</li>
      
    </ul>

    
<nav>
  <ul class="pager">

    
    <li><a href="/categories/ejabberd/">Previous</a></li>
    

    
    <li><a href="/categories/ejabberd/page/3/">Next</a></li>
    

  </ul>
</nav>



  </div>
  <div class="col-md-4">
    
<aside class="l-sidebar">

  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">LATESTS</div>
    </div>
    <div class="list-group">
      
      <a href="https://jeidee.github.io/2017/08/31/upstart-ec84a4eca095/" class="list-group-item">upstart 설정</a>
      
      <a href="https://jeidee.github.io/2017/06/08/centosec9790ec849c-mongodb-ec84a4ecb998ec9980-service-eb93b1eba19d/" class="list-group-item">CentOS에서 MongoDB 설치와 Service 등록</a>
      
      <a href="https://jeidee.github.io/2017/01/25/couchbase-cberlec9790-lcb_cntl-ed95a8ec8898-ecb694eab080/" class="list-group-item">couchbase cberl에 lcb_cntl 함수 추가</a>
      
      <a href="https://jeidee.github.io/2017/01/25/couchbase-cberlec9d98io-pluginec9d84-libeventeba19c-ebb380eab2bd/" class="list-group-item">couchbase cberl의IO Plugin을 libevent로 변경</a>
      
      <a href="https://jeidee.github.io/2017/01/25/ejabberdec9d98-deps-eb9dbcec9db4ebb88ceb9faceba6ac-ec8898eca095-ed9b84-ecbbb4ed8c8cec9dbcec9790ec849c-eb8884eb9dbdeb90a0-eb958c/" class="list-group-item">ejabberd의 deps 라이브러리 수정 후 컴파일에서 누락될 때</a>
      
      <a href="https://jeidee.github.io/2017/01/03/aws-dynamodb-for-go/" class="list-group-item">AWS DynamoDB for Go</a>
      
      <a href="https://jeidee.github.io/2016/12/21/aws-credentialseab080-upstart-eb93b1ec9790ec849c-eca09ceb8c80eba19c-eb8f99ec9e91ed9598eca780-ec958aec9d84-eab2bdec9ab0/" class="list-group-item">AWS Credentials가 upstart 등에서 제대로 동작하지 않을 경우</a>
      
      <a href="https://jeidee.github.io/2016/09/02/c-rest-sdk/" class="list-group-item">c&#43;&#43; REST SDK</a>
      
      <a href="https://jeidee.github.io/2016/09/01/c-openssl-aes-ecb/" class="list-group-item">c&#43;&#43; openssl AES ECB</a>
      
      <a href="https://jeidee.github.io/2016/09/01/cc-hex-string-to-byte-array/" class="list-group-item">c/c&#43;&#43; hex string to byte array</a>
      
    </div>
  </section>

  
  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">CATEGORY</div>
    </div>
    <div class="list-group">
      
      <a href="https://jeidee.github.io/categories/erlang" class="list-group-item">erlang</a>
      
      <a href="https://jeidee.github.io/categories/ejabberd" class="list-group-item">ejabberd</a>
      
      <a href="https://jeidee.github.io/categories/elixir" class="list-group-item">elixir</a>
      
      <a href="https://jeidee.github.io/categories/ios" class="list-group-item">ios</a>
      
      <a href="https://jeidee.github.io/categories/c&#43;&#43;" class="list-group-item">c&#43;&#43;</a>
      
      <a href="https://jeidee.github.io/categories/node.js" class="list-group-item">node.js</a>
      
      <a href="https://jeidee.github.io/categories/utility" class="list-group-item">utility</a>
      
      <a href="https://jeidee.github.io/categories/android" class="list-group-item">android</a>
      
      <a href="https://jeidee.github.io/categories/go" class="list-group-item">go</a>
      
      <a href="https://jeidee.github.io/categories/couchbase" class="list-group-item">couchbase</a>
      
    </div>
  </section>
  
  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">TAG</div>
    </div>
    <div class="list-group">
      
      <a href="https://jeidee.github.io/tags/tutorial" class="list-group-item">tutorial</a>
      
      <a href="https://jeidee.github.io/tags/ndk" class="list-group-item">ndk</a>
      
      <a href="https://jeidee.github.io/tags/express" class="list-group-item">express</a>
      
      <a href="https://jeidee.github.io/tags/mnesia" class="list-group-item">mnesia</a>
      
      <a href="https://jeidee.github.io/tags/mysql" class="list-group-item">mysql</a>
      
      <a href="https://jeidee.github.io/tags/cberl" class="list-group-item">cberl</a>
      
      <a href="https://jeidee.github.io/tags/clustering" class="list-group-item">clustering</a>
      
      <a href="https://jeidee.github.io/tags/custom-module" class="list-group-item">custom-module</a>
      
      <a href="https://jeidee.github.io/tags/debug" class="list-group-item">debug</a>
      
      <a href="https://jeidee.github.io/tags/http" class="list-group-item">http</a>
      
    </div>
  </section>
  

</aside>


  </div>
</div>

      </div>
    </main>

    <footer class="l-footer">
      <div class="container">
        <p><span class="h-logo">&copy; Erlang &amp; Go</span></p>
        <aside>
          <p>Powered by <a href="https://gohugo.io/">Hugo</a>.</p>
          <p><a href="https://github.com/dim0627/hugo_theme_beg">Beg</a> designed by <a href="http://yet.unresolved.xyz/">Daisuke Tsuji</a>.</p>
        </aside>
      </div>
    </footer>

    <script src="//code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

