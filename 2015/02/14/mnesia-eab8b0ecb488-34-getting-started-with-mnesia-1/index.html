<!DOCTYPE html>
<html lang="ko-kr">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Erlang &amp; Go  | mnesia 기초 3/4 &amp;#8211; Getting Started with Mnesia 1/2</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.51" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.e08a958ae3e530145318b6373195c765.css" rel="stylesheet">
    

    

    
      
    

    

    <meta property="og:title" content="mnesia 기초 3/4 &amp;#8211; Getting Started with Mnesia 1/2" />
<meta property="og:description" content="Erlang 공식 문서 중에 Getting Started with Mnesia문서를 기준으로 몇몇내용을 추가해 다음과 같이 작성해 보았다.
mnesia 시작 mnesia를 시작하기 위해서 다음의 과정이 필요하다.
 erlang node에 mnesia의 데이터가 저장될 경로를 지정하여 erlang shell을 시작한다. 새로운 빈 스키마를 생성한다. 스키마는 데이터베이스의 정보를 포함한다. mnesia DBMS를 시작한다. 테이블을 생성한다. 데이터베이스 정보를 조회한다.  위의 과정을 수행하기 위해 다음과 같이 따라해 보자.
 $ erl -mnesia dir &#39;&quot;tmp/funky&quot;&#39;  tmp/funky 디렉토리에 mnesia 데이터가 저장되도록 -mnesia dir 옵션을 사용해 erlang shell을 시작한다." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jeidee.github.io/2015/02/14/mnesia-eab8b0ecb488-34-getting-started-with-mnesia-1/" /><meta property="article:published_time" content="2015-02-14T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2015-02-14T00:00:00&#43;00:00"/>

<meta itemprop="name" content="mnesia 기초 3/4 &amp;#8211; Getting Started with Mnesia 1/2">
<meta itemprop="description" content="Erlang 공식 문서 중에 Getting Started with Mnesia문서를 기준으로 몇몇내용을 추가해 다음과 같이 작성해 보았다.
mnesia 시작 mnesia를 시작하기 위해서 다음의 과정이 필요하다.
 erlang node에 mnesia의 데이터가 저장될 경로를 지정하여 erlang shell을 시작한다. 새로운 빈 스키마를 생성한다. 스키마는 데이터베이스의 정보를 포함한다. mnesia DBMS를 시작한다. 테이블을 생성한다. 데이터베이스 정보를 조회한다.  위의 과정을 수행하기 위해 다음과 같이 따라해 보자.
 $ erl -mnesia dir &#39;&quot;tmp/funky&quot;&#39;  tmp/funky 디렉토리에 mnesia 데이터가 저장되도록 -mnesia dir 옵션을 사용해 erlang shell을 시작한다.">


<meta itemprop="datePublished" content="2015-02-14T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2015-02-14T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="406">



<meta itemprop="keywords" content="mnesia," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="mnesia 기초 3/4 &amp;#8211; Getting Started with Mnesia 1/2"/>
<meta name="twitter:description" content="Erlang 공식 문서 중에 Getting Started with Mnesia문서를 기준으로 몇몇내용을 추가해 다음과 같이 작성해 보았다.
mnesia 시작 mnesia를 시작하기 위해서 다음의 과정이 필요하다.
 erlang node에 mnesia의 데이터가 저장될 경로를 지정하여 erlang shell을 시작한다. 새로운 빈 스키마를 생성한다. 스키마는 데이터베이스의 정보를 포함한다. mnesia DBMS를 시작한다. 테이블을 생성한다. 데이터베이스 정보를 조회한다.  위의 과정을 수행하기 위해 다음과 같이 따라해 보자.
 $ erl -mnesia dir &#39;&quot;tmp/funky&quot;&#39;  tmp/funky 디렉토리에 mnesia 데이터가 저장되도록 -mnesia dir 옵션을 사용해 erlang shell을 시작한다."/>

  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://jeidee.github.io/" class="f3 fw2 hover-white no-underline white-90 dib">
      Erlang &amp; Go
    </a>
    <div class="flex-l items-center">
      
      









    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3 ph0-l">

    <header class="mt4 w-100">
      <p class="f6 b helvetica tracked">
          
        POSTS
      </p>
      <h1 class="f1 athelas mb1">mnesia 기초 3/4 &amp;#8211; Getting Started with Mnesia 1/2</h1>
      
      <time class="f6 mv4 dib tracked" datetime="2015-02-14T00:00:00Z">February 14, 2015</time>      
      
      
    </header>

    <main class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l">

<p>Erlang 공식 문서 중에 <a href="http://www.erlang.org/doc/apps/mnesia/Mnesia_chap2.html">Getting Started with Mnesia</a>문서를 기준으로 몇몇내용을 추가해 다음과 같이 작성해 보았다.</p>

<h2 id="mnesia-시작">mnesia 시작</h2>

<p>mnesia를 시작하기 위해서 다음의 과정이 필요하다.</p>

<ul>
<li>erlang node에 mnesia의 데이터가 저장될 경로를 지정하여 erlang shell을 시작한다.</li>
<li>새로운 빈 스키마를 생성한다. 스키마는 데이터베이스의 정보를 포함한다.</li>
<li>mnesia DBMS를 시작한다.</li>
<li>테이블을 생성한다.</li>
<li>데이터베이스 정보를 조회한다.</li>
</ul>

<p>위의 과정을 수행하기 위해 다음과 같이 따라해 보자.</p>

<pre><code>      
$ erl -mnesia dir '&quot;tmp/funky&quot;'
  
</code></pre>

<p>tmp/funky 디렉토리에 mnesia 데이터가 저장되도록 -mnesia dir 옵션을 사용해 erlang shell을 시작한다.</p>

<p>그 이후 위에서 언급한 순서대로 다음과 같이 입력한다</p>

<pre><code class="language-erlang">      
Eshell V6.3 (abort with ^G)
      
1&gt; mnesia:create_schema([node()]).
      
ok
      
2&gt; mnesia:start().
      
ok
      
3&gt; mnesia:create_table(funky, []).
      
{atomic,ok}
      
4&gt; mnesia:info().
      
&amp;#8212;&gt; Processes holding locks &lt;&amp;#8212;
      
&amp;#8212;&gt; Processes waiting for locks &lt;&amp;#8212;
      
&amp;#8212;&gt; Participant transactions &lt;&amp;#8212;
      
&amp;#8212;&gt; Coordinator transactions &lt;&amp;#8212;
      
&amp;#8212;&gt; Uncertain transactions &lt;&amp;#8212;
      
&amp;#8212;&gt; Active tables &lt;&amp;#8212;
      
funky : with 0 records occupying 305 words of mem
      
schema : with 2 records occupying 529 words of mem
      
===&gt; System info in version &quot;4.12.4&quot;, debug level = none &lt;===
      
opt_disc. Directory &quot;/Users/shinchangheon/tmp/funky&quot; is used.
      
use fallback at restart = false
      
running db nodes = [nonode@nohost]
      
stopped db nodes = []
      
master node tables = []
      
remote = []
      
ram_copies = [funky]
      
disc_copies = [schema]
      
disc\_only\_copies = []
      
[{nonode@nohost,disc_copies}] = [schema]
      
[{nonode@nohost,ram_copies}] = [funky]
      
3 transactions committed, 0 aborted, 0 restarted, 2 logged to disc
      
0 held locks, 0 in queue; 0 local transactions, 0 remote
      
0 transactions waits for other nodes: []
      
ok
  
</code></pre>

<p>빈 옵션&rsquo;[]&#8217;으로 테이블을 생성하면 메모리에 테이블이 생성되며, 노드가 종료되면 해당 테이블은 사라진다.</p>

<pre><code class="language-erlang">      
Eshell V6.3 (abort with ^G)
      
1&gt; mnesia:info().
      
===&gt; System info in version {mnesia\_not\_loaded,nonode@nohost,
                                      
{1423,913120,829264}}, debug level = none &lt;===
      
opt_disc. Directory &quot;/Users/shinchangheon/tmp/funky&quot; is used.
      
use fallback at restart = false
      
running db nodes = []
      
stopped db nodes = [nonode@nohost]
      
ok
  
</code></pre>

<h2 id="테이블을-생성하기">테이블을 생성하기</h2>

<p>다음과 같은 ERD를 구성한다고 가정해 보자.</p>

<p><img src="http://www.erlang.org/doc/apps/mnesia/company.gif" alt="ER-D" /></p>

<p>Company 데이터베이스에 Dept, Employee, Project 테이블이 있고, Dept와 Employee간에 Manager와 At_dep 관계가 있으며, Employee와 Project간에 In_proj 관계가 있는 구성이다.</p>

<p>우선 각 테이블의 스키마를 구성하기 위해 record를 정의한다. 보통 record정의는 .hrl 파일에 모아두며 .erl 모듈에서 include하여 사용한다.</p>

<p>다음은 company.hrl 파일의 내용이다.</p>

<pre><code class="language-erlang">      
-record(employee, {emp_no,
                         
name,
                         
salary,
                         
sex,
                         
phone,
                         
room_no}).

-record(dept, {id,
                     
name}).

-record(project, {name,
                        
number}).

-record(manager, {emp,
                        
dept}).

-record(at_dep, {emp,
                       
dept_id}).

-record(in_proj, {emp,
                        
proj_name}).
  
</code></pre>

<p>보통 record의 이름과 table 이름은 동일하게 만든다.</p>

<p>company.erl 파일은 다음과 같다.</p>

<pre><code class="language-erlang">      
-module(company).

%% API
      
-export([init/0, start/0]).

-include_lib(&quot;stdlib/include/qlc.hrl&quot;).
      
-include(&quot;company.hrl&quot;).

start() -&gt;
        
mnesia:create_schema([node()]),
        
mnesia:start().

init() -&gt;
        
mnesia:create_table(employee,
          
[{attributes, record_info(fields, employee)}]),
        
mnesia:create_table(dept,
          
[{attributes, record_info(fields, dept)}]),
        
mnesia:create_table(project,
          
[{attributes, record_info(fields, project)}]),
        
mnesia:create_table(manager, [{type, bag},
          
{attributes, record_info(fields, manager)}]),
        
mnesia:create\_table(at\_dep,
          
[{attributes, record\_info(fields, at\_dep)}]),
        
mnesia:create\_table(in\_proj, [{type, bag},
          
{attributes, record\_info(fields, in\_proj)}]).
  
</code></pre>
<ul class="pa0">
  
   <li class="list">
     <a href="/tags/mnesia" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">mnesia</a>
   </li>
  
</ul>
<div class="mt6">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-erlnote-wordpress-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </div>
    </main>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="/2015/02/14/mnesia-eab8b0ecb488-14/">mnesia 기초 1/4</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2015/02/14/mnesia-eab8b0ecb488-44-getting-started-with-mnesia-22/">mnesia 기초 4/4 &amp;#8211; Getting Started with Mnesia 2/2</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2015/02/14/mnesia-eab8b0ecb488-24-match-spec/">mnesia 기초 2/4 &amp;#8211; Match Spec</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://jeidee.github.io/" >
    &copy; 2018 Erlang &amp; Go
  </a>
    <div>








</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
